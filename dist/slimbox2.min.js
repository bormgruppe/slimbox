!function(i){function t(){var t=W.scrollLeft(),e=W.width();i([k,T]).css("left",t+e/2),v&&i(x).css({left:t,top:W.scrollTop(),width:e,height:W.height()})}function e(e){e?i("object").add(E?"select":"embed").each(function(i,t){M[i]=[t,t.style.visibility],t.style.visibility="hidden"}):(i.each(M,function(i,t){t[0].style.visibility=t[1]}),M=[]);var o=e?"bind":"unbind";W[o]("scroll resize",t),i(document)[o]("keydown",n)}function n(t){var e=t.which,n=i.inArray;return n(e,u.closeKeys)>=0?h():n(e,u.nextKeys)>=0?a():n(e,u.previousKeys)>=0?o():null}function o(){return r(g)}function a(){return r(y)}function r(i){return i>=0&&(C=i,p=f[C][0],g=(C||(u.loop?f.length:0))-1,y=(C+1)%f.length||(u.loop?0:-1),c(),k.className="lbLoading",N=new Image,N.onload=s,N.src=p),!1}function l(i){var t=window.innerWidth-20,e=window.innerHeight-120,n=1;i.width>t&&(n=t/i.width);var o=1;i.height>e&&(o=e/i.height);var a=Math.min(n,o);1>a&&(i.width*=a,i.height*=a)}function s(){k.className="";var t={width:N.width,height:N.height};l(t),i(D).css({backgroundImage:"url("+p+")",backgroundSize:t.width+"px "+t.height+"px",visibility:"hidden",display:""}),i(L).width(t.width),i([L,z,I]).height(t.height),i(K).html(f[C][1]||""),i(F).html((f.length>1&&u.counterText||"").replace(/{x}/,C+1).replace(/{y}/,f.length)),g>=0&&(O.src=f[g][0]),y>=0&&(A.src=f[y][0]),b=D.offsetWidth,w=D.offsetHeight;var e=Math.max(0,m-w/2);k.offsetHeight!=w&&i(k).animate({height:w,top:e},u.resizeDuration,u.resizeEasing),k.offsetWidth!=b&&i(k).animate({width:b,marginLeft:-b/2},u.resizeDuration,u.resizeEasing),i(k).queue(function(){i(T).css({width:b,top:e+w,marginLeft:-b/2,visibility:"hidden",display:""}),i(D).css({display:"none",visibility:"",opacity:""}).fadeIn(u.imageFadeDuration,d)})}function d(){g>=0&&i(z).show(),y>=0&&i(I).show(),i(H).css("marginTop",-H.offsetHeight).animate({marginTop:0},u.captionAnimationDuration),T.style.visibility=""}function c(){N.onload=null,N.src=O.src=A.src=p,i([k,D,H]).stop(!0),i([z,I,D,T]).hide()}function h(){return C>=0&&(c(),C=g=y=-1,i(k).hide(),i(x).stop().fadeOut(u.overlayFadeDuration,e)),!1}var u,f,p,g,y,v,m,b,w,x,k,D,L,z,I,T,H,K,F,W=i(window),C=-1,E=!window.XMLHttpRequest,M=[],N=(document.documentElement,{}),O=new Image,A=new Image;i(function(){i("body").append(i([x=i('<div id="lbOverlay" />').click(h)[0],k=i('<div id="lbCenter" />')[0],T=i('<div id="lbBottomContainer" />')[0]]).css("display","none")),D=i('<div id="lbImage" />').appendTo(k).append(L=i('<div style="position: relative;" />').append([z=i('<a id="lbPrevLink" href="#" />').click(o)[0],I=i('<a id="lbNextLink" href="#" />').click(a)[0]])[0])[0],H=i('<div id="lbBottom" />').appendTo(T).append([i('<a id="lbCloseLink" href="#" />').click(h)[0],K=i('<div id="lbCaption" />')[0],F=i('<div id="lbNumber" />')[0],i('<div style="clear: both;" />')[0]])[0]}),i.slimbox=function(n,o,a){return u=i.extend({loop:!1,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},a),"string"==typeof n&&(n=[[n,o]],o=0),m=W.scrollTop()+W.height()/2,b=u.initialWidth,w=u.initialHeight,i(k).css({top:Math.max(0,m-w/2),width:b,height:w,marginLeft:-b/2}).show(),v=E||x.currentStyle&&"fixed"!=x.currentStyle.position,v&&(x.style.position="absolute"),i(x).css("opacity",u.overlayOpacity).fadeIn(u.overlayFadeDuration),t(),e(1),f=n,u.loop=u.loop&&f.length>1,r(o)},i.fn.slimbox=function(t,e,n){e=e||function(i){return[i.href,i.title]},n=n||function(){return!0};var o=this;return o.unbind("click").click(function(){var a,r,l=this,s=0,d=0;for(a=i.grep(o,function(i,t){return n.call(l,i,t)}),r=a.length;r>d;++d)a[d]==l&&(s=d),a[d]=e(a[d],d);return i.slimbox(a,s,t)})}}(jQuery);