!function(i){function e(){var e=F.scrollLeft(),t=F.width();i([x,L]).css("left",e+t/2),y&&i(w).css({left:e,top:F.scrollTop(),width:t,height:F.height()})}function t(t){t?i("object").add(C?"select":"embed").each(function(i,e){E[i]=[e,e.style.visibility],e.style.visibility="hidden"}):(i.each(E,function(i,e){e[0].style.visibility=e[1]}),E=[]);var o=t?"bind":"unbind";F[o]("scroll resize",e),i(document)[o]("keydown",n)}function n(e){var t=e.which,n=i.inArray;return n(t,h.closeKeys)>=0?c():n(t,h.nextKeys)>=0?a():n(t,h.previousKeys)>=0?o():null}function o(){return r(f)}function a(){return r(g)}function r(i){return i>=0&&(W=i,p=u[W][0],f=(W||(h.loop?u.length:0))-1,g=(W+1)%u.length||(h.loop?0:-1),d(),x.className="lbLoading",M=new Image,M.onload=l,M.src=p),!1}function l(){x.className="";var e=window.innerWidth-20,t=window.innerHeight-120,n=M.width,o=M.height,a=1;n>e&&(a=e/n);var r=1;o>t&&(r=t/o);var l=Math.min(a,r);1>l&&(n*=l,o*=l),M.width>n||M.height>o?(i(k).css({backgroundImage:"url("+p+")",backgroundSize:n+"px "+o+"px",visibility:"hidden",display:""}),i(D).width(n),i([D,z,I]).height(o)):(i(k).css({backgroundImage:"url("+p+")",backgroundSize:"",visibility:"hidden",display:""}),i(D).width(M.width),i([D,z,I]).height(M.height)),i(H).html(u[W][1]||""),i(K).html((u.length>1&&h.counterText||"").replace(/{x}/,W+1).replace(/{y}/,u.length)),f>=0&&(N.src=u[f][0]),g>=0&&(O.src=u[g][0]),v=k.offsetWidth,b=k.offsetHeight;var d=Math.max(0,m-b/2);x.offsetHeight!=b&&i(x).animate({height:b,top:d},h.resizeDuration,h.resizeEasing),x.offsetWidth!=v&&i(x).animate({width:v,marginLeft:-v/2},h.resizeDuration,h.resizeEasing),i(x).queue(function(){i(L).css({width:v,top:d+b,marginLeft:-v/2,visibility:"hidden",display:""}),i(k).css({display:"none",visibility:"",opacity:""}).fadeIn(h.imageFadeDuration,s)})}function s(){f>=0&&i(z).show(),g>=0&&i(I).show(),i(T).css("marginTop",-T.offsetHeight).animate({marginTop:0},h.captionAnimationDuration),L.style.visibility=""}function d(){M.onload=null,M.src=N.src=O.src=p,i([x,k,T]).stop(!0),i([z,I,k,L]).hide()}function c(){return W>=0&&(d(),W=f=g=-1,i(x).hide(),i(w).stop().fadeOut(h.overlayFadeDuration,t)),!1}var h,u,p,f,g,y,m,v,b,w,x,k,D,z,I,L,T,H,K,F=i(window),W=-1,C=!window.XMLHttpRequest,E=[],M=(document.documentElement,{}),N=new Image,O=new Image;i(function(){i("body").append(i([w=i('<div id="lbOverlay" />').click(c)[0],x=i('<div id="lbCenter" />')[0],L=i('<div id="lbBottomContainer" />')[0]]).css("display","none")),k=i('<div id="lbImage" />').appendTo(x).append(D=i('<div style="position: relative;" />').append([z=i('<a id="lbPrevLink" href="#" />').click(o)[0],I=i('<a id="lbNextLink" href="#" />').click(a)[0]])[0])[0],T=i('<div id="lbBottom" />').appendTo(L).append([i('<a id="lbCloseLink" href="#" />').click(c)[0],H=i('<div id="lbCaption" />')[0],K=i('<div id="lbNumber" />')[0],i('<div style="clear: both;" />')[0]])[0]}),i.slimbox=function(n,o,a){return h=i.extend({loop:!1,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:400,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:400,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78]},a),"string"==typeof n&&(n=[[n,o]],o=0),m=F.scrollTop()+F.height()/2,v=h.initialWidth,b=h.initialHeight,i(x).css({top:Math.max(0,m-b/2),width:v,height:b,marginLeft:-v/2}).show(),y=C||w.currentStyle&&"fixed"!=w.currentStyle.position,y&&(w.style.position="absolute"),i(w).css("opacity",h.overlayOpacity).fadeIn(h.overlayFadeDuration),e(),t(1),u=n,h.loop=h.loop&&u.length>1,r(o)},i.fn.slimbox=function(e,t,n){t=t||function(i){return[i.href,i.title]},n=n||function(){return!0};var o=this;return o.unbind("click").click(function(){var a,r,l=this,s=0,d=0;for(a=i.grep(o,function(i,e){return n.call(l,i,e)}),r=a.length;r>d;++d)a[d]==l&&(s=d),a[d]=t(a[d],d);return i.slimbox(a,s,e)})}}(jQuery);